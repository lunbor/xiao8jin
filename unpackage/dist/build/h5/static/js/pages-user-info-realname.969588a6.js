(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-info-realname"],{"3c45":function(a,t,e){"use strict";e.r(t);var i=e("b51f"),n=e("9636");for(var s in n)"default"!==s&&function(a){e.d(t,a,function(){return n[a]})}(s);e("a760");var o=e("2877"),r=Object(o["a"])(n["default"],i["a"],i["b"],!1,null,"53a697be",null);t["default"]=r.exports},"6c64":function(a,t,e){var i=e("aaf1");"string"===typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);var n=e("4f06").default;n("01ef8b0a",i,!0,{sourceMap:!1,shadowMode:!1})},9636:function(a,t,e){"use strict";e.r(t);var i=e("ff24"),n=e.n(i);for(var s in i)"default"!==s&&function(a){e.d(t,a,function(){return i[a]})}(s);t["default"]=n.a},a760:function(a,t,e){"use strict";var i=e("6c64"),n=e.n(i);n.a},aaf1:function(a,t,e){t=a.exports=e("2350")(!1),t.push([a.i,"uni-page-body[data-v-53a697be]{height:auto;min-height:100%;background-color:#f7f8fa}.canvas-element[data-v-53a697be]{width:100%;height:auto;background-color:#fff}.uni-card.by-card[data-v-53a697be]{border-radius:%?12?%;-webkit-box-shadow:%?4?% %?4?% %?20?% %?4?% hsla(0,0%,48.2%,.3);box-shadow:%?4?% %?4?% %?20?% %?4?% hsla(0,0%,48.2%,.3)}.by-border-bottom[data-v-53a697be]{border-bottom:%?2?% solid #ecedef}.card_img_bg[data-v-53a697be]{background-color:#fff;\n\t/* background-color: #3369ff; */height:%?590?%;padding:%?30?% %?55?%}.card_tip[data-v-53a697be]{color:#989898\n\t/* color: #9eb9ff; */}.flex-w20[data-v-53a697be]{width:%?40?%}.card_img[data-v-53a697be]{text-align:center;padding-top:%?30?%}.card_img uni-image[data-v-53a697be]{width:%?302?%;height:%?222?%;margin:0 auto}.by-mt-30[data-v-53a697be]{margin-top:%?40?%}.by-dj-btn[data-v-53a697be]{color:#666;border:%?2?% #d7d5d5 solid;padding:%?14?% %?20?%;height:%?30?%;line-height:%?30?%;border-radius:%?12?%;margin-top:%?10?%;margin-right:%?15?%}.by-dj-btn.active[data-v-53a697be]{-webkit-box-ordinal-group:3;-webkit-order:%?2?% #f7f8fa solid;-ms-flex-order:%?2?% #f7f8fa solid;order:%?2?% #f7f8fa solid;color:#d7d5d5}.by-button-submit[data-v-53a697be]{background-color:#fd5950;background:-webkit-gradient(linear,left top,right top,from(#ff7575),to(#fd5950));background:-o-linear-gradient(left,#ff7575,#fd5950);background:linear-gradient(left,#ff7575,#fd5950)}.by-button-submit[disabled][data-v-53a697be]{background-color:#eee;background:-webkit-gradient(linear,left top,right top,from(#d2d2d2),to(#d2d2d2));background:-o-linear-gradient(left,#d2d2d2,#d2d2d2);background:linear-gradient(left,#d2d2d2,#d2d2d2)}.upload-tip[data-v-53a697be]{padding-top:%?10?%}.upload-tip-title[data-v-53a697be]{color:#3a3939;border-bottom:%?2?% solid #e0e0e0;line-height:%?80?%;font-size:%?32?%}.upload-tip-center[data-v-53a697be]{color:#b4b2b2;font-size:%?28?%}.by-mb-30[data-v-53a697be]{padding-bottom:%?30?%}.realname-yes[data-v-53a697be]{background-color:#fff;height:%?600?%;text-align:center;padding-top:%?70?%;border-bottom:%?2?% #e2e2e2 solid}.realname-yes .yes-img[data-v-53a697be]{padding-bottom:%?40?%}.realname-yes .yes-img uni-image[data-v-53a697be]{width:%?317?%;height:%?355?%}.realname-yes .bt-color[data-v-53a697be]{border-top:%?2?% #e2e2e2 solid}.by-sdhf[data-v-53a697be]{width:%?120?%;height:%?52?%;line-height:%?80?%;color:#576175;font-weight:600;margin-right:%?20?%;margin-left:%?20?%;text-align:justify}.by-sdhf uni-text[data-v-53a697be]{display:inline-block;height:%?0?%;width:100%}.top-jd[data-v-53a697be]{top:0;left:0;width:100%;text-align:center;position:absolute}body.?%PAGE?%[data-v-53a697be]{background-color:#f7f8fa}",""])},b51f:function(a,t,e){"use strict";var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("v-uni-view",[e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:a.progress>0,expression:"progress>0"}],staticClass:"top-jd"},[e("v-uni-progress",{attrs:{percent:a.progress}})],1),e("v-uni-view",{staticStyle:{overflow:"scroll",height:"0upx",width:"100%"}},[e("v-uni-canvas",{staticClass:"canvas-element",style:{width:a.cwidth,height:a.cheight},attrs:{"canvas-id":"canvas"}})],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:1===a.cardInfo.is_validate,expression:"cardInfo.is_validate===1"}]},[e("v-uni-view",{staticClass:"realname-yes"},[e("v-uni-view",{staticClass:"yes-img"},[e("v-uni-image",{attrs:{src:"../../../static/realname-yes.png"}})],1),e("v-uni-view",{staticClass:"uni-list-cell-navigate bt-color"},[a._v("姓名"),e("v-uni-text",{staticClass:"uni-list-cell-left by-sdh"},[a._v(a._s(a.cardInfo.realname))])],1),e("v-uni-view",{staticClass:"uni-list-cell-navigate bt-color"},[a._v("身份证号"),e("v-uni-text",{staticClass:"uni-list-cell-left by-sdh"},[a._v(a._s(a.cardInfo.card))])],1)],1)],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:0===a.cardInfo.is_validate,expression:"cardInfo.is_validate===0"}]},[e("v-uni-view",{staticClass:"card_img_bg",staticStyle:{display:"none"}},[e("v-uni-view",{staticClass:"card_tip"},[a._v("请上传本人有效期内的身份证照片，享受更多权益")]),e("v-uni-view",{staticClass:"uni-flex uni-row",staticStyle:{"justify-content":"center"}},[e("v-uni-view",{staticClass:"text card_img"},[e("v-uni-image",{attrs:{src:"../../../static/card_a_sl.png"}})],1),e("v-uni-view",{staticClass:"text flex-w20"}),e("v-uni-view",{staticClass:"text card_img",on:{click:function(t){t=a.$handleEvent(t),a.chooseImage(t)}}},[e("v-uni-image",{attrs:{src:a.cardInfo.card_img_a?a.cardInfo.card_img_a:"../../../static/card_a.png"}})],1)],1),e("v-uni-view",{staticClass:"uni-flex uni-row",staticStyle:{"justify-content":"center"}},[e("v-uni-view",{staticClass:"text card_img"},[e("v-uni-image",{attrs:{src:"../../../static/card_b_sl.png"}})],1),e("v-uni-view",{staticClass:"text flex-w20"}),e("v-uni-view",{staticClass:"text card_img",on:{click:function(t){t=a.$handleEvent(t),a.chooseImageB(t)}}},[e("v-uni-image",{attrs:{src:a.cardInfo.card_img_b?a.cardInfo.card_img_b:"../../../static/card_b.png"}})],1)],1)],1),e("v-uni-view",{staticClass:"uni-padding-wrap"},[e("v-uni-view",{staticClass:"uni-card by-card"},[e("v-uni-view",{staticClass:"uni-card-content"},[e("v-uni-view",{staticClass:"uni-form-item uni-column by-border-bottom"},[e("v-uni-view",{staticClass:"with-fun"},[e("v-uni-view",{staticClass:"by-sdhf"},[a._v("真实姓名"),e("v-uni-text")],1),e("v-uni-input",{staticClass:"uni-input",attrs:{maxlength:"20",placeholder:""},model:{value:a.cardInfo.realname,callback:function(t){a.$set(a.cardInfo,"realname",t)},expression:"cardInfo.realname"}})],1)],1),e("v-uni-view",{staticClass:"uni-form-item uni-column"},[e("v-uni-view",{staticClass:"with-fun"},[e("v-uni-view",{staticClass:"by-sdhf"},[a._v("身份证号"),e("v-uni-text")],1),e("v-uni-input",{staticClass:"uni-input",attrs:{type:"idcard",placeholder:""},model:{value:a.cardInfo.card,callback:function(t){a.$set(a.cardInfo,"card",t)},expression:"cardInfo.card"}})],1)],1)],1)],1),e("v-uni-view",{staticClass:"by-mt-30 by-mb-30"},[e("v-uni-button",{staticClass:"by-button-submit",attrs:{type:"warn",disabled:1===a.cardInfo.is_validate,loading:a.loading},on:{click:function(t){t=a.$handleEvent(t),a.addIdCard(t)}}},[a._v("提交认证")])],1)],1)],1)],1)},n=[];e.d(t,"a",function(){return i}),e.d(t,"b",function(){return n})},ff24:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(e("a34a"));function n(a){return a&&a.__esModule?a:{default:a}}function s(a,t,e,i,n,s,o){try{var r=a[s](o),d=r.value}catch(c){return void e(c)}r.done?t(d):Promise.resolve(d).then(i,n)}function o(a){return function(){var t=this,e=arguments;return new Promise(function(i,n){var o=a.apply(t,e);function r(a){s(o,i,n,r,d,"next",a)}function d(a){s(o,i,n,r,d,"throw",a)}r(void 0)})}}var r=null,d={data:function(){return{cardInfo:{realname:"",is_validate:"",card:"",card_img_a:"../../../static/card_a.png",card_img_b:"../../../static/card_b.png"},loading:!1,card_a:[],card_b:[],card_a_data:"",card_b_data:"",progress:0,cwidth:"1000px",cheight:"1000px"}},onReady:function(){r=uni.createCanvasContext("canvas")},onLoad:function(){this.getIdCard()},onShow:function(){},methods:{getIdCard:function(){var a=this,t=this.$store.state.openid,e=this.$store.state.sessionKey;try{this.$http.post(this.websiteUrl+"/api/api/getIdCard",{openid:t,sessionKey:e},function(t){1==t.data.code?(a.cardInfo=t.data.result.cardInfo,null==a.cardInfo.card&&(a.cardInfo.card=""),null==a.cardInfo.realname&&(a.cardInfo.realname="")):uni.showModal({content:t.data.msg,showCancel:!1})})}catch(i){uni.showModal({content:"网络异常,请稍后重试...",showCancel:!1})}},addIdCard:function(){var a=this.$store.state.openid,t=this.$store.state.sessionKey,e=this.cardInfo.realname,i=this.cardInfo.card;if(""!=e)if(""!=i){var n=this;try{if(this.loading)return;this.loading=!0,this.$http.post(this.websiteUrl+"/api/api/addIdCard",{openid:a,sessionKey:t,realname:e,card:i},function(a){uni.showModal({content:a.data.msg,showCancel:!1,success:function(){n.loading=!1,uni.redirectTo({url:"/pages/user/info/realname"})}})})}catch(s){uni.showModal({content:"网络异常,请稍后重试...",showCancel:!1,success:function(){n.loading=!1}})}}else uni.showModal({content:"请填写身份证号码",showCancel:!1});else uni.showModal({content:"请填写真实姓名",showCancel:!1})},upFile:function(a,t){var e=this,i=this.$store.state.openid,n=this.$store.state.sessionKey,s=uni.uploadFile({url:this.websiteUrl+"/api/upload/uploadcard",filePath:a,name:"file",formData:{data:JSON.stringify({openid:i,sessionKey:n,side:t})},success:function(a){var i=JSON.parse(a.data);uni.hideLoading(),1==i.code?"front"==t?1==i.result.juhe?0==i.result.juhedata.error_code?(e.card_a_data=i.result.img_url,e.cardInfo.realname=i.result.juhedata.result.realname,e.cardInfo.card=i.result.juhedata.result.idcard,uni.showToast({title:"成功"})):uni.showModal({content:i.result.juhedata.reason,showCancel:!1}):(e.card_a_data=i.result.img_url,uni.showToast({title:"成功"})):1==i.result.juhe?0==i.result.juhedata.error_code?(e.card_b_data=i.result.img_url,uni.showToast({title:"成功"})):uni.showModal({content:i.result.juhedata.reason,showCancel:!1}):(e.card_b_data=i.result.img_url,uni.showToast({title:"成功"})):uni.showToast({title:i.msg})},fail:function(a){console.log(a),uni.hideLoading(),uni.showToast({title:"上传失败"})},complete:function(a){e.progress=0}});s.onProgressUpdate(function(a){e.progress=a.progress})},resethb:function(){},chooseImage:function(){var a=o(i.default.mark(function a(){var t,e=this;return i.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t=this,t.progress=0,uni.chooseImage({sizeType:["compressed"],sourceType:["camera"],count:1,success:function(a){e.card_a=[],e.card_a=e.card_a.concat(a.tempFilePaths);var i=e.card_a.length;if(i>=1){e.cardInfo.card_img_a=e.card_a[i-1];var n=a.tempFilePaths,s="front";uni.showLoading({title:"识别中..."});try{return void uni.getImageInfo({src:n[i-1],success:function(a){t.resethb(),a.width>1e3?(t.cwidth=a.width/7+"px",t.cheight=a.height/7+"px",r.drawImage(n[i-1],0,0,a.width/7,a.height/7),r.draw(!1,function(){uni.canvasToTempFilePath({canvasId:"canvas",success:function(a){t.upFile(a.tempFilePath,s)},fail:function(a){console.error(JSON.stringify(a)),uni.hideLoading(),uni.showToast({title:"图片压缩失败"})}})})):t.upFile(n[i-1],s)}})}catch(o){uni.hideLoading()}}else uni.showToast({title:"没有选中图片"})}});case 3:case"end":return a.stop()}},a,this)}));function t(){return a.apply(this,arguments)}return t}(),chooseImageB:function(){var a=o(i.default.mark(function a(){var t,e=this;return i.default.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t=this,this.$store.state.openid,this.$store.state.sessionKey,t.progress=0,uni.chooseImage({sizeType:["compressed"],sourceType:["camera"],count:1,success:function(a){e.card_b=[],e.card_b=e.card_b.concat(a.tempFilePaths);var i=e.card_b.length;if(i>=1){e.cardInfo.card_img_b=e.card_b[i-1];var n=a.tempFilePaths,s="back";uni.showLoading({title:"识别中..."});try{return void uni.getImageInfo({src:n[i-1],success:function(a){t.resethb(),a.width>1e3?(t.cwidth=a.width/7+"px",t.cheight=a.height/7+"px",r.drawImage(n[i-1],0,0,a.width/7,a.height/7),r.draw(!1,function(){uni.canvasToTempFilePath({canvasId:"canvas",success:function(a){t.upFile(a.tempFilePath,s)},fail:function(a){console.error(JSON.stringify(a)),uni.hideLoading(),uni.showToast({title:"图片压缩失败"})}})})):t.upFile(n[i-1],s)}})}catch(o){uni.hideLoading()}}else uni.showToast({title:"没有选中图片"})}});case 5:case"end":return a.stop()}},a,this)}));function t(){return a.apply(this,arguments)}return t}()}};t.default=d}}]);