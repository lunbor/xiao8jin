(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-info-realname"],{"1f65":function(t,a,e){"use strict";e.r(a);var i=e("b69e"),n=e("9e4a");for(var s in n)"default"!==s&&function(t){e.d(a,t,function(){return n[t]})}(s);e("97e7");var o=e("2877"),r=Object(o["a"])(n["default"],i["a"],i["b"],!1,null,"39706f70",null);a["default"]=r.exports},"44e2":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=n(e("a34a"));function n(t){return t&&t.__esModule?t:{default:t}}function s(t,a,e,i,n,s,o){try{var r=t[s](o),d=r.value}catch(c){return void e(c)}r.done?a(d):Promise.resolve(d).then(i,n)}function o(t){return function(){var a=this,e=arguments;return new Promise(function(i,n){var o=t.apply(a,e);function r(t){s(o,i,n,r,d,"next",t)}function d(t){s(o,i,n,r,d,"throw",t)}r(void 0)})}}var r=null,d={data:function(){return{cardInfo:{realname:"",is_validate:"",card:"",card_img_a:"../../../static/card_a.png",card_img_b:"../../../static/card_b.png"},loading:!1,card_a:[],card_b:[],card_a_data:"",card_b_data:"",progress:0,cwidth:"1000px",cheight:"1000px"}},onReady:function(){r=uni.createCanvasContext("canvas")},onLoad:function(){this.getIdCard()},onShow:function(){},methods:{getIdCard:function(){var t=this,a=this.$store.state.openid,e=this.$store.state.sessionKey;try{this.$http.post(this.websiteUrl+"/api/api/getIdCard",{openid:a,sessionKey:e},function(a){1==a.data.code?(t.cardInfo=a.data.result.cardInfo,null==t.cardInfo.card&&(t.cardInfo.card=""),null==t.cardInfo.realname&&(t.cardInfo.realname="")):uni.showModal({content:a.data.msg,showCancel:!1})})}catch(i){uni.showModal({content:"网络异常,请稍后重试...",showCancel:!1})}},addIdCard:function(){var t=this.$store.state.openid,a=this.$store.state.sessionKey,e=this.cardInfo.realname,i=this.cardInfo.card;if(""!=e)if(""!=i){var n=this;try{if(this.loading)return;this.loading=!0,this.$http.post(this.websiteUrl+"/api/api/addIdCard",{openid:t,sessionKey:a,realname:e,card:i},function(t){uni.showModal({content:t.data.msg,showCancel:!1,success:function(){n.loading=!1,uni.redirectTo({url:"/pages/user/info/realname"})}})})}catch(s){uni.showModal({content:"网络异常,请稍后重试...",showCancel:!1,success:function(){n.loading=!1}})}}else uni.showModal({content:"请填写身份证号码",showCancel:!1});else uni.showModal({content:"请填写真实姓名",showCancel:!1})},upFile:function(t,a){var e=this,i=this.$store.state.openid,n=this.$store.state.sessionKey,s=uni.uploadFile({url:this.websiteUrl+"/api/upload/uploadcard",filePath:t,name:"file",formData:{data:JSON.stringify({openid:i,sessionKey:n,side:a})},success:function(t){var i=JSON.parse(t.data);uni.hideLoading(),1==i.code?"front"==a?1==i.result.juhe?0==i.result.juhedata.error_code?(e.card_a_data=i.result.img_url,e.cardInfo.realname=i.result.juhedata.result.realname,e.cardInfo.card=i.result.juhedata.result.idcard,uni.showToast({title:"成功"})):uni.showModal({content:i.result.juhedata.reason,showCancel:!1}):(e.card_a_data=i.result.img_url,uni.showToast({title:"成功"})):1==i.result.juhe?0==i.result.juhedata.error_code?(e.card_b_data=i.result.img_url,uni.showToast({title:"成功"})):uni.showModal({content:i.result.juhedata.reason,showCancel:!1}):(e.card_b_data=i.result.img_url,uni.showToast({title:"成功"})):uni.showToast({title:i.msg})},fail:function(t){console.log(t),uni.hideLoading(),uni.showToast({title:"上传失败"})},complete:function(t){e.progress=0}});s.onProgressUpdate(function(t){e.progress=t.progress})},resethb:function(){},chooseImage:function(){var t=o(i.default.mark(function t(){var a,e=this;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a=this,a.progress=0,uni.chooseImage({sizeType:["compressed"],sourceType:["camera"],count:1,success:function(t){e.card_a=[],e.card_a=e.card_a.concat(t.tempFilePaths);var i=e.card_a.length;if(i>=1){e.cardInfo.card_img_a=e.card_a[i-1];var n=t.tempFilePaths,s="front";uni.showLoading({title:"识别中..."});try{return void uni.getImageInfo({src:n[i-1],success:function(t){a.resethb(),t.width>1e3?(a.cwidth=t.width/7+"px",a.cheight=t.height/7+"px",r.drawImage(n[i-1],0,0,t.width/7,t.height/7),r.draw(!1,function(){uni.canvasToTempFilePath({canvasId:"canvas",success:function(t){a.upFile(t.tempFilePath,s)},fail:function(t){console.error(JSON.stringify(t)),uni.hideLoading(),uni.showToast({title:"图片压缩失败"})}})})):a.upFile(n[i-1],s)}})}catch(o){uni.hideLoading()}}else uni.showToast({title:"没有选中图片"})}});case 3:case"end":return t.stop()}},t,this)}));function a(){return t.apply(this,arguments)}return a}(),chooseImageB:function(){var t=o(i.default.mark(function t(){var a,e=this;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a=this,this.$store.state.openid,this.$store.state.sessionKey,a.progress=0,uni.chooseImage({sizeType:["compressed"],sourceType:["camera"],count:1,success:function(t){e.card_b=[],e.card_b=e.card_b.concat(t.tempFilePaths);var i=e.card_b.length;if(i>=1){e.cardInfo.card_img_b=e.card_b[i-1];var n=t.tempFilePaths,s="back";uni.showLoading({title:"识别中..."});try{return void uni.getImageInfo({src:n[i-1],success:function(t){a.resethb(),t.width>1e3?(a.cwidth=t.width/7+"px",a.cheight=t.height/7+"px",r.drawImage(n[i-1],0,0,t.width/7,t.height/7),r.draw(!1,function(){uni.canvasToTempFilePath({canvasId:"canvas",success:function(t){a.upFile(t.tempFilePath,s)},fail:function(t){console.error(JSON.stringify(t)),uni.hideLoading(),uni.showToast({title:"图片压缩失败"})}})})):a.upFile(n[i-1],s)}})}catch(o){uni.hideLoading()}}else uni.showToast({title:"没有选中图片"})}});case 5:case"end":return t.stop()}},t,this)}));function a(){return t.apply(this,arguments)}return a}()}};a.default=d},"97e7":function(t,a,e){"use strict";var i=e("ce4d"),n=e.n(i);n.a},"9e4a":function(t,a,e){"use strict";e.r(a);var i=e("44e2"),n=e.n(i);for(var s in i)"default"!==s&&function(t){e.d(a,t,function(){return i[t]})}(s);a["default"]=n.a},b69e:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",[e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.progress>0,expression:"progress>0"}],staticClass:"top-jd"},[e("v-uni-progress",{attrs:{percent:t.progress}})],1),e("v-uni-view",{staticStyle:{overflow:"scroll",height:"0upx",width:"100%"}},[e("v-uni-canvas",{staticClass:"canvas-element",style:{width:t.cwidth,height:t.cheight},attrs:{"canvas-id":"canvas"}})],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:1===t.cardInfo.is_validate,expression:"cardInfo.is_validate===1"}]},[e("v-uni-view",{staticClass:"realname-yes"},[e("v-uni-view",{staticClass:"yes-img"},[e("v-uni-image",{attrs:{src:"../../../static/realname-yes.png"}})],1),e("v-uni-view",{staticClass:"uni-list-cell-navigate bt-color"},[t._v("姓名"),e("v-uni-text",{staticClass:"uni-list-cell-left by-sdh"},[t._v(t._s(t.cardInfo.realname))])],1),e("v-uni-view",{staticClass:"uni-list-cell-navigate bt-color"},[t._v("身份证号"),e("v-uni-text",{staticClass:"uni-list-cell-left by-sdh"},[t._v(t._s(t.cardInfo.card))])],1)],1)],1),e("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:0===t.cardInfo.is_validate,expression:"cardInfo.is_validate===0"}]},[e("v-uni-view",{staticClass:"card_img_bg",staticStyle:{display:"none"}},[e("v-uni-view",{staticClass:"card_tip"},[t._v("请上传本人有效期内的身份证照片，享受更多权益")]),e("v-uni-view",{staticClass:"uni-flex uni-row",staticStyle:{"justify-content":"center"}},[e("v-uni-view",{staticClass:"text card_img"},[e("v-uni-image",{attrs:{src:"../../../static/card_a_sl.png"}})],1),e("v-uni-view",{staticClass:"text flex-w20"}),e("v-uni-view",{staticClass:"text card_img",on:{click:function(a){a=t.$handleEvent(a),t.chooseImage(a)}}},[e("v-uni-image",{attrs:{src:t.cardInfo.card_img_a?t.cardInfo.card_img_a:"../../../static/card_a.png"}})],1)],1),e("v-uni-view",{staticClass:"uni-flex uni-row",staticStyle:{"justify-content":"center"}},[e("v-uni-view",{staticClass:"text card_img"},[e("v-uni-image",{attrs:{src:"../../../static/card_b_sl.png"}})],1),e("v-uni-view",{staticClass:"text flex-w20"}),e("v-uni-view",{staticClass:"text card_img",on:{click:function(a){a=t.$handleEvent(a),t.chooseImageB(a)}}},[e("v-uni-image",{attrs:{src:t.cardInfo.card_img_b?t.cardInfo.card_img_b:"../../../static/card_b.png"}})],1)],1)],1),e("v-uni-view",{staticClass:"uni-padding-wrap"},[e("v-uni-view",{staticClass:"uni-card by-card"},[e("v-uni-view",{staticClass:"uni-card-content"},[e("v-uni-view",{staticClass:"uni-form-item uni-column by-border-bottom"},[e("v-uni-view",{staticClass:"with-fun"},[e("v-uni-view",{staticClass:"by-sdhf"},[t._v("真实姓名"),e("v-uni-text")],1),e("v-uni-input",{staticClass:"uni-input",attrs:{maxlength:"20",placeholder:""},model:{value:t.cardInfo.realname,callback:function(a){t.$set(t.cardInfo,"realname",a)},expression:"cardInfo.realname"}})],1)],1),e("v-uni-view",{staticClass:"uni-form-item uni-column"},[e("v-uni-view",{staticClass:"with-fun"},[e("v-uni-view",{staticClass:"by-sdhf"},[t._v("身份证号"),e("v-uni-text")],1),e("v-uni-input",{staticClass:"uni-input",attrs:{type:"idcard",placeholder:""},model:{value:t.cardInfo.card,callback:function(a){t.$set(t.cardInfo,"card",a)},expression:"cardInfo.card"}})],1)],1)],1)],1),e("v-uni-view",{staticClass:"by-mt-30 by-mb-30"},[e("v-uni-button",{staticClass:"by-button-submit",attrs:{type:"warn",disabled:1===t.cardInfo.is_validate,loading:t.loading},on:{click:function(a){a=t.$handleEvent(a),t.addIdCard(a)}}},[t._v("提交认证")])],1)],1)],1)],1)},n=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return n})},ce4d:function(t,a,e){var i=e("e89a");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("4f06").default;n("523eb2c0",i,!0,{sourceMap:!1,shadowMode:!1})},e89a:function(t,a,e){a=t.exports=e("2350")(!1),a.push([t.i,"uni-page-body[data-v-39706f70]{height:auto;min-height:100%;background-color:#f7f8fa}.canvas-element[data-v-39706f70]{width:100%;height:auto;background-color:#fff}.uni-card.by-card[data-v-39706f70]{border-radius:%?12?%;-webkit-box-shadow:%?4?% %?4?% %?20?% %?4?% hsla(0,0%,48.2%,.3);box-shadow:%?4?% %?4?% %?20?% %?4?% hsla(0,0%,48.2%,.3)}.by-border-bottom[data-v-39706f70]{border-bottom:%?2?% solid #ecedef}.card_img_bg[data-v-39706f70]{background-color:#fff;\n\t/* background-color: #3369ff; */height:%?590?%;padding:%?30?% %?55?%}.card_tip[data-v-39706f70]{color:#989898\n\t/* color: #9eb9ff; */}.flex-w20[data-v-39706f70]{width:%?40?%}.card_img[data-v-39706f70]{text-align:center;padding-top:%?30?%}.card_img uni-image[data-v-39706f70]{width:%?302?%;height:%?222?%;margin:0 auto}.by-mt-30[data-v-39706f70]{margin-top:%?40?%}.by-dj-btn[data-v-39706f70]{color:#666;border:%?2?% #d7d5d5 solid;padding:%?14?% %?20?%;height:%?30?%;line-height:%?30?%;border-radius:%?12?%;margin-top:%?10?%;margin-right:%?15?%}.by-dj-btn.active[data-v-39706f70]{-webkit-box-ordinal-group:3;-webkit-order:%?2?% #f7f8fa solid;-ms-flex-order:%?2?% #f7f8fa solid;order:%?2?% #f7f8fa solid;color:#d7d5d5}.by-button-submit[data-v-39706f70]{background-color:#fd5950;background:-webkit-gradient(linear,left top,right top,from(#ff7575),to(#fd5950));background:-o-linear-gradient(left,#ff7575,#fd5950);background:linear-gradient(left,#ff7575,#fd5950)}.by-button-submit[disabled][data-v-39706f70]{background-color:#eee;background:-webkit-gradient(linear,left top,right top,from(#d2d2d2),to(#d2d2d2));background:-o-linear-gradient(left,#d2d2d2,#d2d2d2);background:linear-gradient(left,#d2d2d2,#d2d2d2)}.upload-tip[data-v-39706f70]{padding-top:%?10?%}.upload-tip-title[data-v-39706f70]{color:#3a3939;border-bottom:%?2?% solid #e0e0e0;line-height:%?80?%;font-size:%?32?%}.upload-tip-center[data-v-39706f70]{color:#b4b2b2;font-size:%?28?%}.by-mb-30[data-v-39706f70]{padding-bottom:%?30?%}.realname-yes[data-v-39706f70]{background-color:#fff;height:%?600?%;text-align:center;padding-top:%?70?%;border-bottom:%?2?% #e2e2e2 solid}.realname-yes .yes-img[data-v-39706f70]{padding-bottom:%?40?%}.realname-yes .yes-img uni-image[data-v-39706f70]{width:%?317?%;height:%?355?%}.realname-yes .bt-color[data-v-39706f70]{border-top:%?2?% #e2e2e2 solid}.by-sdhf[data-v-39706f70]{width:%?120?%;height:%?52?%;line-height:%?80?%;color:#576175;font-weight:600;margin-right:%?20?%;margin-left:%?20?%;text-align:justify}.by-sdhf uni-text[data-v-39706f70]{display:inline-block;height:%?0?%;width:100%}.top-jd[data-v-39706f70]{top:0;left:0;width:100%;text-align:center;position:absolute}body.?%PAGE?%[data-v-39706f70]{background-color:#f7f8fa}",""])}}]);