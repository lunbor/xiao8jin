(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/im-chat/im-chat"],{"0f83":function(t,e,n){"use strict";n.r(e);var s=n("b388"),i=n("4eb9");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("aa03");var o=n("2877"),u=Object(o["a"])(i["default"],s["a"],s["b"],!1,null,null,null);e["default"]=u.exports},2141:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={name:"chat-input",data:function(){return{inputValue:""}},methods:{startRecognize:function(){var t={},e=this;t.engine="iFly",e.inputValue="",plus.speech.startRecognize(t,function(t){console.log(t),e.inputValue+=t},function(t){console.log("语音识别失败："+t.message)})},sendMessge:function(){var t=this;""==t.inputValue.trim()?t.inputValue="":(this.$emit("send-message",{type:"text",content:t.inputValue}),t.inputValue="")}}};e.default=s},4134:function(t,e,n){"use strict";var s=n("e30e"),i=n.n(s);i.a},"496c":function(t,e,n){"use strict";n.r(e);var s=n("2141"),i=n.n(s);for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);e["default"]=i.a},"4eb9":function(t,e,n){"use strict";n.r(e);var s=n("8506"),i=n.n(s);for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);e["default"]=i.a},"73d3":function(t,e,n){"use strict";n.r(e);var s=n("9e69"),i=n("9c6a");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("a2e7");var o=n("2877"),u=Object(o["a"])(i["default"],s["a"],s["b"],!1,null,null,null);e["default"]=u.exports},8506:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={props:["message","id"]};e.default=s},"8e963":function(t,e,n){"use strict";n.r(e);var s=n("995e"),i=n("496c");for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);n("4134");var o=n("2877"),u=Object(o["a"])(i["default"],s["a"],s["b"],!1,null,null,null);e["default"]=u.exports},"995e":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"footer"},[n("view",{staticClass:"footer-left"},[n("view",{staticClass:"uni-icon uni-icon-mic",attrs:{eventid:"3f37201f-0"},on:{tap:t.startRecognize}})]),n("view",{staticClass:"footer-center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],staticClass:"input-text",attrs:{type:"text",eventid:"3f37201f-1"},domProps:{value:t.inputValue},on:{input:function(e){e.target.composing||(t.inputValue=e.target.value)}}})]),n("view",{staticClass:"footer-right",attrs:{eventid:"3f37201f-2"},on:{tap:t.sendMessge}},[n("view",{attrs:{id:"msg-type"}},[t._v("发送")])])])},i=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return i})},"9c6a":function(t,e,n){"use strict";n.r(e);var s=n("d229"),i=n.n(s);for(var a in s)"default"!==a&&function(t){n.d(e,t,function(){return s[t]})}(a);e["default"]=i.a},"9e69":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"uni-column"},[n("view",{staticClass:"content",style:{height:t.style.contentViewHeight+"px"},attrs:{id:"content"}},[n("scroll-view",{style:{height:t.style.contentViewHeight+"px"},attrs:{id:"scrollview","scroll-y":"true","scroll-with-animation":!0,"scroll-top":t.scrollTop}},[t._l(t.messages,function(t,e){return n("message-show",{key:e,attrs:{message:t,id:e,mpcomid:"22836324-0-"+e}})}),n("view",{attrs:{id:"bottom"}})],2)],1),n("view",{staticClass:"foot"},[n("chat-input",{attrs:{eventid:"22836324-0",mpcomid:"22836324-1"},on:{"send-message":t.getInputMessage,focus:t.inputGetFocus}})],1)])},i=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return i})},a2e7:function(t,e,n){"use strict";var s=n("decb"),i=n.n(s);i.a},aa03:function(t,e,n){"use strict";var s=n("e3aa"),i=n.n(s);i.a},aba2:function(t,e,n){"use strict";n("a8bc");var s=a(n("b0ce")),i=a(n("73d3"));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(i.default))},b388:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("view",{staticClass:"m-item",attrs:{id:"message"+t.id}},[n("view",{staticClass:"m-left"},["home"==t.message.user?n("image",{staticClass:"head_icon",attrs:{src:"http://hszt.tw186.com/uploads/img/homeHL.png"}}):t._e()]),n("view",{staticClass:"m-content"},[n("view",{staticClass:"m-content-head",class:{"m-content-head-right":"customer"==t.message.user}},[n("view",{class:"m-content-head-"+t.message.user},[t._v(t._s(t.message.content))])])]),n("view",{staticClass:"m-right"},["customer"==t.message.user?n("image",{staticClass:"head_icon",attrs:{src:"http://hszt.tw186.com/uploads/img/customerHL.png"}}):t._e()])])},i=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return i})},d229:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(n("8e963")),i=a(n("0f83"));function a(t){return t&&t.__esModule?t:{default:t}}var o={data:function(){return{style:{pageHeight:0,contentViewHeight:0,footViewHeight:90,mitemHeight:0},scrollTop:0,messages:[{user:"home",type:"head",content:"你好!"}]}},components:{chatInput:s.default,messageShow:i.default},onLoad:function(){var e=t.getSystemInfoSync();this.style.pageHeight=e.windowHeight,this.style.contentViewHeight=e.windowHeight-t.getSystemInfoSync().screenWidth/750*100},methods:{getInputMessage:function(t){this.addMessage("customer",t.content,!1),this.toRobot(t.content)},addMessage:function(t,e,n,s){var i=this;i.messages.push({user:t,content:e,hasSub:n,subcontent:s})},scrollToBottom:function(){var e=this,n=t.createSelectorQuery();n.selectAll(".m-item").boundingClientRect(),n.select("#scrollview").boundingClientRect(),n.exec(function(t){e.style.mitemHeight=0,t[0].forEach(function(t){e.style.mitemHeight=e.style.mitemHeight+t.height+20}),e.style.mitemHeight>e.style.contentViewHeight&&(e.scrollTop=e.style.mitemHeight-e.style.contentViewHeight)})},toRobot:function(e){var n=this,s=this.$store.state.openid,i=this.$store.state.sessionKey;try{this.$http.post(this.websiteUrl+"/api/chatapi/api",{openid:s,sessionKey:i,info:e},function(e){1==e.data.code?(n.addMessage("home",e.data.result,!1),n.scrollToBottom()):t.showModal({content:e.data.msg,showCancel:!1})})}catch(a){this.loadingType=0,t.showModal({content:"网络异常,请稍后重试...",showCancel:!1})}}}};e.default=o}).call(this,n("649d")["default"])},decb:function(t,e,n){},e30e:function(t,e,n){},e3aa:function(t,e,n){}},[["aba2","common/runtime","common/vendor"]]]);